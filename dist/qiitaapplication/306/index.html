<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>wp-app</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="## Build Setup"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/runtime.8b17cd4.js" as="script"><link rel="preload" href="/_nuxt/vendors/commons.ca01d4b.js" as="script"><link rel="preload" href="/_nuxt/app.1984cc1.js" as="script"><link rel="preload" href="/_nuxt/pages/_slug/_id.b892f06.js" as="script"><style data-vue-ssr-id="fa7ff0ca:0 56b15182:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}html{font-family:"Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{display:inline-block;border-radius:4px;border:1px solid #3b8070;color:#3b8070;text-decoration:none;padding:10px 30px}.button--green:hover{color:#fff;background-color:#3b8070}.button--grey{display:inline-block;border-radius:4px;border:1px solid #35495e;color:#35495e;text-decoration:none;padding:10px 30px;margin-left:15px}.button--grey:hover{color:#fff;background-color:#35495e}</style><link rel="preload" href="/_nuxt/static/1598415284/qiitaapplication/306/payload.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div><div class="post"><h1>検索結果が0件の場合の処理</h1> <div class="content"><p>RecyclerViewにおいてitemsが0件の場合は「検索結果が0件です」のcellを表示する。<br>
ただし、RecyclerViewの初期設定中は必ず0件の状態になってしまう。<br>
なので初期設定中は、getItemCount()で0件を返し、「検索結果が0件です」のcellは表示しないようにする。<br>
初期設定完了後は、getItemCount()で1件を返し、「検索結果が0件です」のcellを表示する。</p>


<div class="mb60"></div>



<p class="filename">ArticleAdapter.kt</p>



<pre class="EnlighterJSRAW" data-enlighter-language="kotlin" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="28" data-enlighter-title="" data-enlighter-group="">    // スワイプ更新中に「検索結果が0件です」を出さない為の対応
    private var hasCompletedFirstRefresh = false</pre>



<p>説明した処理の部分</p>



<p>items.isEmpty()がtrueの場合は、hasCompletedFirstRefreshで判別する</p>



<pre class="EnlighterJSRAW" data-enlighter-language="kotlin" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="170" data-enlighter-title="" data-enlighter-group="">    /**
     * getItemCountメソッド
     *
     * @return Int
     */
    override fun getItemCount(): Int {
        // リストデータ中の件数をリターン。
        return if (items.isEmpty()) {
            if (hasCompletedFirstRefresh)
                1
            else
                0
        } else items.size
    }
    /**
     * itemsの数によってVIEW_TYPEを振り分け
     *
     * @param position
     * @return VIEW_TYPE: Int
     */

    override fun getItemViewType(position: Int): Int {
        return if (items.isEmpty() ) VIEW_TYPE_EMPTY else VIEW_TYPE_ITEM
    }</pre>



<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="3,7" data-enlighter-linenumbers="false" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {

        if (viewType == VIEW_TYPE_ITEM) {

・・・

        } else {
            return EmptyViewHolder(
                LayoutInflater.from(context).inflate(R.layout.empty_row, parent, false)
            )
        }
    }</pre>



<pre class="EnlighterJSRAW" data-enlighter-language="kotlin" data-enlighter-theme="" data-enlighter-highlight="202,217" data-enlighter-linenumbers="" data-enlighter-lineoffset="195" data-enlighter-title="" data-enlighter-group="">    /**
     * refreshメソッド
     *
     * @param qiitaList
     */
    fun refresh(qiitaList: List&lt;QiitaData>) {
        // リフレッシュ実行フラグON
        hasCompletedFirstRefresh = true
        items.apply {
            clear()
            addAll(qiitaList)
        }

        notifyDataSetChanged()
    }

    /**
     * clearメソッド
     *
     */
    fun clear() {
        // 上スワイプで「検索結果0件」表示のバグ対応
        hasCompletedFirstRefresh = false
        items.apply {
            clear()
        }
        notifyDataSetChanged()
    }</pre>
</div></div></div></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1598415284",layout:"default",error:null,serverRendered:!0,routePath:"/qiitaapplication/306/",config:{}}</script><script src="/_nuxt/runtime.8b17cd4.js" defer></script><script src="/_nuxt/pages/_slug/_id.b892f06.js" defer></script><script src="/_nuxt/vendors/commons.ca01d4b.js" defer></script><script src="/_nuxt/app.1984cc1.js" defer></script>
  </body>
</html>
